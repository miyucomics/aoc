For today, I had two radically different solutions: one before I had the great idea and one after.

For before, it was quite simple really. I precomputed the distances, sorted them to get a list of in-order which pairs to connect, and went through the list. Every circuit has a single integer id used to refer to it and there was a lookup for what circuit a box belonged to, as well as one to see the size of a given circuit by its id. We then just go connection by connection and connected them. If a was already in and b was not, b took on the id of a and the circuit size of a's circuit increased by one. Same vice versa. If neither of them were in, they received a new never-before-used id thanks to the working id which increments, and the size of that new circuit is 2. Finally if they were both in, we just go through and change all of them to point towards one of them. We simulate that either a thousand times or until we have seen all the boxes and the circuit size lookup has only one circuit, and we print the requested value.

For after my grand vision, I realized that the individual circuits were not of importance. Instead, we just keep track of parents and grow that specific circuit size.
